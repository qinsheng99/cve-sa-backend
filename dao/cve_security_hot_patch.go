package dao

import (
	"gorm.io/gorm"

	"cve-sa-backend/iniconf"
	"cve-sa-backend/models"
)

type securityHotPatch struct {
}

var DefaultSecurityHotPatch = securityHotPatch{}

func (s securityHotPatch) DeleteHotPatch(securityNumber string, tx *gorm.DB) (err error) {
	err = tx.Model(&models.CveSecurityHotPatch{}).
		Where("security_notice_no = ?", securityNumber).
		Delete(nil).Error

	return
}

func (s securityHotPatch) CreateHotPatch(datas []models.CveSecurityHotPatch, tx *gorm.DB) (err error) {
	err = tx.Model(&models.CveSecurityHotPatch{}).Create(&datas).Error

	return
}

func (s securityHotPatch) HotPatchList(filter *models.CveSecurityHotPatch) (
	v []models.CveSecurityHotPatch, err error,
) {
	err = iniconf.DB.Model(filter).Where(filter).Find(&v).Error

	return
}
